# Priors are conprised of several components:
# ChIP-seq, KO RNA-seq, A known network and ATAC-seq data.

# In progress

# chip + ko + ATAC + network prior
chip_sp = read.table("/workdir/hz543/projects/Inferelator/cd8_rerun/inputs/prior/chip_nofli1_sp.tsv", header = T)
atac_sp = read.table("/workdir/hz543/projects/Inferelator/cd8/inputs/prior/output_prior/prior_atac_b_sp.tsv", header = T)
ko_sp = read.table("/workdir/hz543/projects/Inferelator/cd8/GS/ko_sp.tsv", header = T)
network_sp = read.table("/workdir/hz543/projects/Inferelator/cd8/GS/TN_network/network_sp.tsv", header = T)

chip_atac_sp = rbind(chip_sp, atac_sp)
chip_ko_atac_sp = rbind(ko_sp, chip_atac_sp)
chip_ko_network_atac_sp = rbind(network_sp, chip_ko_atac_sp)
chip_ko_network_atac = data.frame(matrix(0, ncol = length(unique(chip_ko_network_atac_sp$TF)), nrow = length(unique(chip_ko_network_atac_sp$Target))))
colnames(chip_ko_network_atac) = unique(chip_ko_network_atac_sp$TF)
rownames(chip_ko_network_atac) = unique(chip_ko_network_atac_sp$Target)

for (i in 1:nrow(chip_ko_atac_sp)){
    chip_ko_network_atac[as.character(chip_ko_network_atac_sp[i, 'Target']), as.character(chip_ko_network_atac_sp[i, 'TF'])] = 1
}
write.table(chip_ko_network_atac, "prior/priors_more_than_atac_nofli1/chip_ko_network_atac.tsv", quote = F, sep = "\t", col.names=NA)
